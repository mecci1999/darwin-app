# SaaS化系统环境配置文件
# 复制此文件为 .env 并填入实际配置值

# 基础配置
NODE_ENV=development
PORT=3000
API_URL=http://localhost:3000
FRONTEND_URL=http://localhost:3001

# 数据库配置
# MySQL 配置
MYSQL_HOST=localhost
MYSQL_PORT=3306
MYSQL_DATABASE=darwin_saas
MYSQL_USERNAME=root
MYSQL_PASSWORD=password
MYSQL_CONNECTION_LIMIT=10

# InfluxDB 配置
INFLUXDB_URL=http://localhost:8086
INFLUXDB_TOKEN=your-influxdb-token
INFLUXDB_ORG=your-org
INFLUXDB_BUCKET=metrics
INFLUXDB_BATCH_SIZE=1000
INFLUXDB_FLUSH_INTERVAL=10000

# Redis 配置
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_KEY_PREFIX=darwin_saas:

# Kafka 配置
KAFKA_BROKERS=localhost:9092
KAFKA_CLIENT_ID=darwin-saas
KAFKA_GROUP_ID=darwin-saas-group
KAFKA_TOPICS_METRICS=metrics.raw
KAFKA_TOPICS_EVENTS=system.events
KAFKA_TOPICS_NOTIFICATIONS=user.notifications

# JWT 配置
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# 加密配置
ENCRYPTION_KEY=your-32-character-encryption-key-here
HASH_SALT_ROUNDS=12

# 邮件配置
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
SMTP_FROM_NAME=Darwin SaaS
SMTP_FROM_EMAIL=noreply@darwin-saas.com

# 短信配置（阿里云短信服务）
ALIYUN_SMS_ACCESS_KEY_ID=your-access-key-id
ALIYUN_SMS_ACCESS_KEY_SECRET=your-access-key-secret
ALIYUN_SMS_REGION=cn-hangzhou
ALIYUN_SMS_SIGN_NAME=Darwin监控
ALIYUN_SMS_TEMPLATE_CODE=SMS_123456789

# 支付配置
# 支付宝配置
ALIPAY_APP_ID=your-alipay-app-id
ALIPAY_PRIVATE_KEY=your-alipay-private-key
ALIPAY_PUBLIC_KEY=your-alipay-public-key
ALIPAY_GATEWAY_URL=https://openapi.alipay.com/gateway.do
ALIPAY_NOTIFY_URL=${API_URL}/subscription/payment/notify
ALIPAY_RETURN_URL=${FRONTEND_URL}/subscription/success

# 微信支付配置
WECHATPAY_MCH_ID=your-wechatpay-mch-id
WECHATPAY_APP_ID=your-wechatpay-app-id
WECHATPAY_API_KEY=your-wechatpay-api-key
WECHATPAY_CERT_PATH=./certs/wechatpay/apiclient_cert.pem
WECHATPAY_KEY_PATH=./certs/wechatpay/apiclient_key.pem
WECHATPAY_NOTIFY_URL=${API_URL}/subscription/payment/notify

# Stripe 配置（可选）
STRIPE_PUBLIC_KEY=pk_test_your-stripe-public-key
STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key
STRIPE_WEBHOOK_SECRET=whsec_your-stripe-webhook-secret

# 文件存储配置
# 本地存储
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=10485760

# 阿里云OSS配置（可选）
ALIYUN_OSS_ACCESS_KEY_ID=your-oss-access-key-id
ALIYUN_OSS_ACCESS_KEY_SECRET=your-oss-access-key-secret
ALIYUN_OSS_REGION=oss-cn-hangzhou
ALIYUN_OSS_BUCKET=darwin-saas-files
ALIYUN_OSS_ENDPOINT=https://oss-cn-hangzhou.aliyuncs.com

# 监控和日志配置
# Prometheus 配置
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
PROMETHEUS_METRICS_PATH=/metrics

# 日志配置
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_ENABLED=true
LOG_FILE_PATH=./logs/app.log
LOG_FILE_MAX_SIZE=100m
LOG_FILE_MAX_FILES=10

# 安全配置
# CORS 配置
CORS_ORIGIN=${FRONTEND_URL}
CORS_CREDENTIALS=true

# 速率限制配置
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# API 密钥配置
API_KEY_LENGTH=32
API_KEY_PREFIX=dk_
API_KEY_RATE_LIMIT_DEFAULT=1000

# 缓存配置
CACHE_TTL_DEFAULT=3600
CACHE_TTL_USER_QUOTA=300
CACHE_TTL_SUBSCRIPTION=1800
CACHE_TTL_API_KEY=600

# 数据处理配置
# 批处理配置
BATCH_SIZE_METRICS=1000
BATCH_TIMEOUT_MS=5000
BATCH_MAX_RETRIES=3

# 数据保留配置
DATA_RETENTION_FREE_DAYS=7
DATA_RETENTION_BASIC_DAYS=30
DATA_RETENTION_PRO_DAYS=90
DATA_RETENTION_ENTERPRISE_DAYS=365

# 配额检查配置
QUOTA_CHECK_INTERVAL_MS=60000
QUOTA_WARNING_THRESHOLD=0.8
QUOTA_CRITICAL_THRESHOLD=0.95

# 通知配置
NOTIFICATION_EMAIL_ENABLED=true
NOTIFICATION_SMS_ENABLED=false
NOTIFICATION_WEBHOOK_ENABLED=true
NOTIFICATION_RETRY_ATTEMPTS=3
NOTIFICATION_RETRY_DELAY_MS=5000

# 账单配置
BILLING_CURRENCY_DEFAULT=USD
BILLING_TAX_RATE=0.0
BILLING_INVOICE_PREFIX=INV
BILLING_DUE_DAYS=30
BILLING_REMINDER_DAYS=3

# 试用配置
TRIAL_PERIOD_DAYS=14
TRIAL_PLAN_NAME=Pro
TRIAL_AUTO_DOWNGRADE=true
TRIAL_DOWNGRADE_PLAN=Free

# 功能开关
FEATURE_CUSTOM_SCHEMAS=true
FEATURE_ADVANCED_ANALYTICS=true
FEATURE_TEAM_MANAGEMENT=true
FEATURE_WEBHOOK_NOTIFICATIONS=true
FEATURE_API_RATE_LIMITING=true
FEATURE_DATA_EXPORT=true
FEATURE_AUDIT_LOGS=true

# 第三方服务配置
# Google Analytics（可选）
GOOGLE_ANALYTICS_ID=GA_MEASUREMENT_ID

# Sentry 错误监控（可选）
SENTRY_DSN=your-sentry-dsn
SENTRY_ENVIRONMENT=${NODE_ENV}

# 健康检查配置
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_TIMEOUT_MS=5000

# 开发环境配置
DEV_MOCK_PAYMENTS=true
DEV_SKIP_EMAIL_VERIFICATION=false
DEV_AUTO_APPROVE_REFUNDS=true
DEV_SEED_DATA=true

# 生产环境配置
PROD_FORCE_HTTPS=true
PROD_TRUST_PROXY=true
PROD_SESSION_SECURE=true
PROD_HELMET_ENABLED=true